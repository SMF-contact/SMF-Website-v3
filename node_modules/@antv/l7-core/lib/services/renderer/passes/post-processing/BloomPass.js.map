{"version":3,"sources":["../../../../../src/services/renderer/passes/post-processing/BloomPass.ts"],"names":["BloomPass","shaderModuleService","registerModule","vs","quad","fs","blur","getModule","uniforms","rendererService","getViewportSize","width","height","u_ViewportSize","options","bloomRadius","u_radius","bloomIntensity","u_intensity","bloomBaseRadio","u_baseRadio","BasePostProcessingPass"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;;AAEA;;AAIA;;;;;;;;;;;;;;IASqBA,S,WADpB,4B;;;;;;;;;;;;WAIC,wBAAyB;AACvB,WAAKC,mBAAL,CAAyBC,cAAzB,CAAwC,WAAxC,EAAqD;AACnDC,QAAAA,EAAE,EAAEC,IAD+C;AAEnDC,QAAAA,EAAE,EAAEC;AAF+C,OAArD;;AAKA,kCAA6B,KAAKL,mBAAL,CAAyBM,SAAzB,CAC3B,WAD2B,CAA7B;AAAA,UAAQJ,EAAR,yBAAQA,EAAR;AAAA,UAAYE,EAAZ,yBAAYA,EAAZ;AAAA,UAAgBG,QAAhB,yBAAgBA,QAAhB;;AAGA,kCAA0B,KAAKC,eAAL,CAAqBC,eAArB,EAA1B;AAAA,UAAQC,KAAR,yBAAQA,KAAR;AAAA,UAAeC,MAAf,yBAAeA,MAAf;;AAEA,aAAO;AACLT,QAAAA,EAAE,EAAFA,EADK;AAELE,QAAAA,EAAE,EAAFA,EAFK;AAGLG,QAAAA,QAAQ,kCACHA,QADG;AAENK,UAAAA,cAAc,EAAE,CAACF,KAAD,EAAQC,MAAR;AAFV;AAHH,OAAP;AAQD;;;WAED,kCACEE,OADF,EAIS;AACP,UAAMN,QAEL,GAAG,EAFJ;;AAIA,UAAI,CAAC,qBAAMM,OAAO,CAACC,WAAd,CAAL,EAAiC;AAC/BP,QAAAA,QAAQ,CAACQ,QAAT,GAAoBF,OAAO,CAACC,WAA5B;AACD;;AACD,UAAI,CAAC,qBAAMD,OAAO,CAACG,cAAd,CAAL,EAAoC;AAClCT,QAAAA,QAAQ,CAACU,WAAT,GAAuBJ,OAAO,CAACG,cAA/B;AACD;;AACD,UAAI,CAAC,qBAAMH,OAAO,CAACK,cAAd,CAAL,EAAoC;AAClCX,QAAAA,QAAQ,CAACY,WAAT,GAAuBN,OAAO,CAACK,cAA/B;AACD;;AAED,aAAOX,QAAP;AACD;;;EA5CoCa,+B","sourcesContent":["import { injectable } from 'inversify';\nimport { isNil } from 'lodash';\nimport 'reflect-metadata';\nimport blur from '../../../../shaders/post-processing/bloom.glsl';\nimport quad from '../../../../shaders/post-processing/quad.glsl';\nimport { IUniform } from '../../IUniform';\nimport BasePostProcessingPass from '../BasePostProcessingPass';\n\nexport interface IBloomPassConfig {\n  bloomBaseRadio: number;\n  bloomRadius: number;\n  bloomIntensity: number;\n}\n\n@injectable()\nexport default class BloomPass extends BasePostProcessingPass<\n  IBloomPassConfig\n> {\n  protected setupShaders() {\n    this.shaderModuleService.registerModule('blur-pass', {\n      vs: quad,\n      fs: blur,\n    });\n\n    const { vs, fs, uniforms } = this.shaderModuleService.getModule(\n      'blur-pass',\n    );\n    const { width, height } = this.rendererService.getViewportSize();\n\n    return {\n      vs,\n      fs,\n      uniforms: {\n        ...uniforms,\n        u_ViewportSize: [width, height],\n      },\n    };\n  }\n\n  protected convertOptionsToUniforms(\n    options: Partial<IBloomPassConfig>,\n  ): {\n    [uniformName: string]: IUniform;\n  } | void {\n    const uniforms: {\n      [key: string]: IUniform;\n    } = {};\n\n    if (!isNil(options.bloomRadius)) {\n      uniforms.u_radius = options.bloomRadius;\n    }\n    if (!isNil(options.bloomIntensity)) {\n      uniforms.u_intensity = options.bloomIntensity;\n    }\n    if (!isNil(options.bloomBaseRadio)) {\n      uniforms.u_baseRadio = options.bloomBaseRadio;\n    }\n\n    return uniforms;\n  }\n}\n"],"file":"BloomPass.js"}